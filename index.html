<!doctype html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RYAAN JEWELLERS ‚Äî White Diamond Luxury</title>
  <meta name="description" content="RYAAN Jewellers Dubai ‚Äî Luxury diamonds & gold. Live rates, bespoke designs, WhatsApp + card checkout (placeholder)." />
  <meta name="theme-color" content="#0b0b0b" />
  <!-- Fonts & icons -->
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Playfair+Display:wght@400;700&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    /* -------------------- THEME VARIABLES -------------------- */
    :root{
      --rose:#C77B7B;
      --gold: #B58B3C;
      --muted:#8a8a8a;
      --bg:#fff9f8;
      --card:#fff;
      --dark:#0f1720;
      --glass: rgba(255,255,255,0.6);
      --radius:18px;
      --trans:.35s ease;
      --max-width:1200px;
      --lux-scale:1;
    }
    /* Dark (OLED) theme overrides */
    :root[data-theme='dark']{
      --bg:#050405;
      --card:#0e0e10;
      --muted:#bdbdbd;
      --glass: rgba(255,255,255,0.03);
      --lux-scale:1;
    }

    /* RTL support (body[dir='rtl']) will flip layout automatically via flex/grid direction defaults */
    html,body{height:100%}
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:'Inter',system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial;
      background:var(--bg);
      color:var(--dark);
      -webkit-font-smoothing:antialiased;
      line-height:1.5;
      transition:background .35s ease,color .35s ease;
      font-size:16px;
    }

    /* Container */
    .container{max-width:var(--max-width);margin:0 auto;padding:18px}

    /* -------------------- SPLASH (BIG BOX) -------------------- */
    #splash{
      position:fixed;inset:0;z-index:99999;display:flex;align-items:center;justify-content:center;
      background:linear-gradient(180deg,rgba(0,0,0,0.85),rgba(0,0,0,0.95));
      padding:24px;
    }
    .splash-box{
      width:min(1100px,95%);background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.02));
      border-radius:24px;padding:26px;display:flex;gap:26px;align-items:center;backdrop-filter: blur(6px);
      box-shadow:0 40px 120px rgba(0,0,0,0.7);
    }
    .splash-media{flex:0 0 360px;border-radius:18px;overflow:hidden;border:1px solid rgba(255,255,255,0.04)}
    .splash-media video{width:100%;height:100%;display:block;object-fit:cover}
    .splash-content{flex:1;color:#fff}
    .splash-title{font-family:'Cinzel',serif;font-size:44px;font-weight:900;letter-spacing:1px;margin-bottom:6px}
    .splash-sub{color:#f3eaea;opacity:0.9;margin-bottom:18px}
    .splash-actions{display:flex;gap:12px;align-items:center}
    .splash-play{background:transparent;border:1px solid rgba(255,255,255,0.2);color:#fff;padding:12px 18px;border-radius:999px;cursor:pointer}
    .splash-muted{background:rgba(255,255,255,0.08);padding:8px 10px;border-radius:10px;color:#fff;border:0}
    .splash-note{font-size:13px;color:#ddd;margin-top:10px}

    /* -------------------- HEADER -------------------- */
    header{position:sticky;top:0;z-index:800;background:linear-gradient(180deg,rgba(255,255,255,0.95),rgba(255,255,255,0.98));backdrop-filter: blur(8px);border-bottom:1px solid rgba(199,123,123,.06)}
    .header-inner{max-width:var(--max-width);margin:0 auto;padding:14px 20px;display:flex;align-items:center;gap:18px;justify-content:space-between}
    .brand{display:flex;align-items:center;gap:10px;cursor:pointer}
    .brand .logo-video{width:150px;height:150px;border-radius:10%;overflow:hidden;border:1px solid rgba(199,123,123,.06)}
    .brand h1{font-family:'Cinzel',serif;font-size:22px;margin:0;letter-spacing:0.6px}
    nav ul{display:flex;gap:18px;list-style:none;align-items:center}
    nav a{padding:6px 10px;border-radius:8px;font-weight:700;color:var(--dark);text-decoration:none;transition:all .2s ease}
    nav a:hover{background:var(--glass);color:var(--rose)}
    .header-actions{display:flex;gap:10px;align-items:center}
    .icon-btn{padding:9px 12px;border-radius:10px;background:transparent;border:1px solid rgba(199,123,123,.08);cursor:pointer}
    .cart-count{background:var(--rose);color:#fff;padding:4px 8px;border-radius:20px;font-weight:800;margin-left:6px;font-size:13px}
    .search{display:flex;align-items:center;gap:8px;border-radius:12px;padding:6px 8px;border:1px solid rgba(15,23,32,.06);background:var(--card);min-width:340px}
    .search input{border:0;outline:0;padding:8px;font-size:14px;background:transparent}

    /* Big luxury header style (large font in header) */
    .brand h1{font-size:24px}

    /* -------------------- HERO -------------------- */
    .hero{min-height:60vh;display:flex;align-items:center;justify-content:center;padding:70px 18px;background:linear-gradient(135deg,#fff7f6,#f8ecec)}
    .hero-inner{text-align:center;max-width:980px}
    .hero-tag{display:inline-block;padding:8px 24px;background:var(--rose);color:#fff;border-radius:999px;font-weight:800;margin-bottom:18px}
    .hero-title{font-family:'Playfair Display',serif;font-size:56px;line-height:1.02;margin-top:6px;margin-bottom:12px;color:var(--dark)}
    .hero-sub{color:var(--muted);font-size:18px;max-width:820px;margin:0 auto}

    /* -------------------- RATES -------------------- */
    .rates{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;padding:16px}
    .rate-card{background:linear-gradient(135deg, var(--card), #fff);padding:20px;border-radius:16px;border:1px solid rgba(199,123,123,0.1);min-width:180px;text-align:center;box-shadow:0 8px 24px rgba(0,0,0,0.08);transition:transform 0.3s ease, box-shadow 0.3s ease}
    .rate-card:hover{transform:translateY(-4px);box-shadow:0 12px 32px rgba(199,123,123,0.15)}
    .rate-title{font-size:13px;color:var(--muted);text-transform:uppercase;letter-spacing:0.5px;margin-bottom:8px}
    .rate-value{font-family:'Cinzel',serif;font-size:24px;color:var(--gold);font-weight:900;margin:8px 0}
    .rate-time{font-size:11px;color:var(--muted);margin-top:6px;opacity:0.8}

    /* -------------------- LAYOUT -------------------- */
    .layout{max-width:var(--max-width);margin:28px auto;padding:0 18px;display:grid;grid-template-columns:1fr 360px;gap:26px}
    @media(max-width:1100px){ .layout{grid-template-columns:1fr} }

    /* Slider */
    .slider{border-radius:14px;overflow:hidden}
    .track{display:flex;gap:14px;transition:transform .45s ease}
    .slide{min-width:320px;border-radius:12px;background:var(--card);overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,.06)}
    .slide img{width:100%;height:260px;object-fit:cover}
    .meta{padding:14px}
    .slider-controls{display:flex;gap:8px;justify-content:center;margin-top:12px}

    /* Filters, controls */
    .controls-row{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;margin:18px 0}
    .filter-row{display:flex;gap:8px;flex-wrap:wrap}
    .filter-row button{padding:8px 14px;border-radius:20px;border:1px solid rgba(199,123,123,.08);background:transparent;cursor:pointer}
    .filter-row button.active{background:var(--rose);color:#fff;border-color:var(--rose)}

    .sort-select{padding:8px 10px;border-radius:10px;border:1px solid rgba(15,23,32,.06)}

    /* Product grid */
    .products-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:18px}
    .product{background:var(--card);border-radius:12px;overflow:hidden;border:1px solid rgba(199,123,123,.06);transition:transform var(--trans),box-shadow var(--trans)}
    .product:hover{transform:translateY(-8px);box-shadow:0 20px 40px rgba(199,123,123,.12)}
    .product img{width:100%;height:220px;object-fit:cover}
    .info{padding:12px}
    .name{font-weight:800;margin-bottom:6px}
    .desc{font-size:13px;color:var(--muted);margin-bottom:12px}
    .price{font-family:'Cinzel',serif;color:var(--rose);font-size:18px;font-weight:900}

    /* side cart */
    .side{position:sticky;top:88px;padding:18px;background:var(--card);border-radius:12px;border:1px solid rgba(199,123,123,.04)}
    .cart-preview{display:flex;flex-direction:column;gap:12px}
    .cart-item{display:flex;gap:12px;align-items:center}
    .cart-item img{width:70px;height:70px;object-fit:cover;border-radius:8px}
    .cart-total{font-weight:900;color:var(--rose);font-size:18px;margin-top:6px}

    /* modal */
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:1200}
    .modal-box{background:var(--card);padding:18px;border-radius:14px;max-width:920px;width:94%;max-height:92vh;overflow:auto}
    .modal-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media(max-width:800px){ .modal-grid{grid-template-columns:1fr} }

    /* buttons */
    .btn{padding:10px 18px;border-radius:999px;border:none;cursor:pointer;font-weight:800}
    .btn-primary{background:var(--rose);color:#fff}
    .btn-outline{background:transparent;border:1px solid rgba(15,23,32,.06)}

    /* notify & debug */
    #notify{position:fixed;right:18px;top:90px;display:none;background:var(--rose);color:#fff;padding:12px 18px;border-radius:10px;font-weight:700;z-index:2000}
    .debug-info{background:#fff3cd;border:1px solid #ffeaa7;border-radius:8px;padding:12px;margin:12px 0;font-size:13px;color:#856404}

    /* small screens */
    @media(max-width:600px){
      .splash-box{flex-direction:column;align-items:center}
      .splash-media{width:88%;flex:unset}
      .hero-title{font-size:32px}
      .search{min-width:160px}
      .rate-card{min-width:140px;padding:16px}
      .rate-value{font-size:20px}
    }

  </style>
</head>

<body>
  <!-- ========== SPLASH (big box with video + sound control) ========== -->
  <div id="splash" aria-hidden="false">
    <div class="splash-box" role="dialog" aria-modal="true" aria-label="RYAAN splash">
      <div class="splash-media">
        <!-- splash video (muted by default due to autoplay restrictions) -->
        <video id="splashVideo" playsinline autoplay muted loop src="https://raw.githubusercontent.com/ryaanjewellers007/ryaanjewellers/main/Ryaan%20Jewellers.mp4"></video>
      </div>
      <div class="splash-content">
        <div class="splash-title">RYAAN JEWELLERS</div>
        <div class="splash-sub">White Diamond Luxury ‚Äî Dubai</div>
        <div class="splash-actions">
          <button id="enterBtn" class="splash-play">Enter RYAAN</button>
          <button id="soundToggle" class="splash-muted" aria-pressed="false"><i class="fas fa-volume-mute"></i> Enable Sound</button>
        </div>
        <div class="splash-note">Tip: enable sound for the full cinematic splash. You can disable later.</div>
      </div>
    </div>
  </div>

  <!-- ========== HEADER ========== -->
  <header>
    <div class="header-inner">
      <div class="brand" onclick="window.scrollTo({top:0,behavior:'smooth'})" role="button" tabindex="0">
        <div class="logo-video">
          <video id="logoVid" autoplay loop muted playsinline src="https://raw.githubusercontent.com/ryaanjewellers007/ryaanjewellers/main/LogoDec.mp4" style="width:100%;height:100%;object-fit:cover"></video>
        </div>
        <div>
          <h1>RYAAN JEWELLERS</h1>
          <div style="font-size:12px;color:var(--muted)">Dubai ‚Ä¢ Handcrafted Luxury</div>
        </div>
      </div>

      <div style="display:flex;align-items:center;gap:12px">
        <div class="search" role="search" aria-label="Search products">
          <input id="searchInput" placeholder="Search designs, rings, necklaces..." aria-label="Search products">
          <button id="searchBtn" class="icon-btn" title="Search"><i class="fas fa-search"></i></button>
        </div>

        <nav aria-label="Main Nav">
          <ul>
            <li><a href="#home">Home</a></li>
            <li><a href="#collections">Collections</a></li>
            <li><a href="#custom">Custom</a></li>
            <li><a href="#contact">Contact</a></li>
          </ul>
        </nav>

        <div class="header-actions">
          <button id="themeToggle" class="icon-btn" title="Toggle theme"><i class="fas fa-moon"></i></button>
          <button id="dirToggle" class="icon-btn" title="Toggle LTR/RTL">AR</button>
          <button class="icon-btn" onclick="document.getElementById('goldRates').scrollIntoView({behavior:'smooth'})" title="Gold rates"><i class="fas fa-coins"></i></button>
          <button class="icon-btn" onclick="openCart()" title="Open cart"><i class="fas fa-shopping-bag"></i> <span class="cart-count" id="cartCount"></span></button>
        </div>
      </div>
    </div>
  </header>

  <!-- ========== HERO ========== -->
  <main id="home">
    <section class="hero">
      <div class="hero-inner">
        <div class="hero-tag">Signature Masterpieces</div>
        <h1 class="hero-title">Elegant. Timeless. Crafted for you.</h1>
        <p class="hero-sub">Exclusive diamond & gold jewellery handcrafted in Dubai ‚Äî bespoke services, live gold rates, secure checkout.</p>
        <div style="margin-top:18px">
          <button class="btn btn-primary" onclick="document.getElementById('collections').scrollIntoView({behavior:'smooth'})">Explore Collections</button>
          <button class="btn btn-outline" onclick="document.getElementById('custom').scrollIntoView({behavior:'smooth'})">Custom Design</button>
        </div>
      </div>
    </section>

    <!-- ========== GOLD RATES ========== -->
    <section id="goldRates" class="container rates" aria-live="polite" style="justify-content:center">
      <div class="rate-card">
        <div class="rate-title">24K / gram</div>
        <div class="rate-value" id="rate24">‚Äî</div>
        <div class="rate-time" id="rateTime">‚Äî</div>
      </div>
      <div class="rate-card">
        <div class="rate-title">22K / gram</div>
        <div class="rate-value" id="rate22">‚Äî</div>
      </div>
      <div class="rate-card">
        <div class="rate-title">18K / gram</div>
        <div class="rate-value" id="rate18">‚Äî</div>
      </div>
    </section>

    <!-- ========== LAYOUT (MAIN + SIDE) ========== -->
    <div class="layout">

      <!-- MAIN -->
      <section class="main-col">
        <div class="container">
          <h2 class="section-title">Featured Collection</h2>
          <div class="slider" aria-label="Featured products">
            <div class="track" id="sliderTrack" role="list"></div>
          </div>
          <div class="slider-controls" style="margin-top:12px">
            <button class="icon-btn" onclick="prevSlide()" aria-label="Previous"><i class="fas fa-chevron-left"></i></button>
            <button class="icon-btn" onclick="nextSlide()" aria-label="Next"><i class="fas fa-chevron-right"></i></button>
          </div>
        </div>

        <!-- Controls -->
        <div class="container" style="margin-top:22px">
          <div class="controls-row">
            <div class="filter-row" id="filterRow" role="toolbar" aria-label="Filter">
              <button class="active" onclick="applyFilter('all', this)">All</button>
              <button onclick="applyFilter('bracelet', this)">Bracelets</button>
              <button onclick="applyFilter('necklace', this)">Necklaces</button>
              <button onclick="applyFilter('ring', this)">Rings</button>
              <button onclick="applyFilter('earrings', this)">Earrings</button>
              <button onclick="applyFilterByCategory('Messika Collection', this)">Messika</button>
            </div>

            <div style="display:flex;gap:8px;align-items:center">
              <select id="sortSelect" class="sort-select" onchange="applySort(this.value)" aria-label="Sort products">
                <option value="featured">Featured</option>
                <option value="price-asc">Price low ‚Üí high</option>
                <option value="price-desc">Price high ‚Üí low</option>
                <option value="name-asc">A ‚Üí Z</option>
              </select>
              <button class="icon-btn" title="Refresh" onclick="renderProducts()">Refresh</button>
            </div>
          </div>
        </div>

        <!-- Products grid -->
        <div class="container" id="collections">
          <h2 class="section-title">All Luxury Products</h2>
          <div class="products-grid" id="productsGrid" aria-live="polite"></div>
        </div>

        <!-- Debug (missing images) -->
        <div class="container" id="debugSection" style="display:none">
          <div class="debug-info">
            <strong>Image debug</strong>
            <ul id="debugList" style="margin-top:8px"></ul>
            <small style="display:block;margin-top:8px;color:#6b4e00">Upload missing images to your GitHub repository to replace placeholders.</small>
          </div>
        </div>

        <!-- Custom -->
        <section id="custom" class="container" style="margin-top:18px">
          <h2 class="section-title">Custom Design</h2>
          <p style="color:var(--muted);margin-top:6px">From idea to masterpiece ‚Äî 3D design, approval and handcrafting.</p>
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px;margin-top:12px">
            <div style="padding:18px;background:var(--card);border-radius:12px;border:1px solid rgba(199,123,123,.06);text-align:center">
              <i class="fas fa-comments" style="font-size:28px;color:var(--rose);margin-bottom:8px"></i>
              <h4>Consultation</h4>
              <p style="color:var(--muted)">Share your ideas with our designers</p>
            </div>
            <div style="padding:18px;background:var(--card);border-radius:12px;border:1px solid rgba(199,123,123,.06);text-align:center">
              <i class="fas fa-cube" style="font-size:28px;color:var(--rose);margin-bottom:8px"></i>
              <h4>3D Modeling</h4>
              <p style="color:var(--muted)">Digital preview before crafting</p>
            </div>
            <div style="padding:18px;background:var(--card);border-radius:12px;border:1px solid rgba(199,123,123,.06);text-align:center">
              <i class="fas fa-gem" style="font-size:28px;color:var(--rose);margin-bottom:8px"></i>
              <h4>Handcraft & Delivery</h4>
              <p style="color:var(--muted)">Master artisans bring design to life</p>
            </div>
          </div>
          <div style="text-align:center;margin-top:18px"><button class="btn btn-primary" onclick="openCustomInquiry()">Start Custom Design ‚Äî WhatsApp</button></div>
        </section>

      </section>

      <!-- SIDE: CART -->
      <aside class="side" aria-label="Cart & Summary">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="font-family:'Cinzel',serif;font-weight:800;color:var(--rose)">Your Cart</div>
          <div style="font-size:13px;color:var(--muted)">Saved locally</div>
        </div>

        <div class="cart-preview" id="cartPreview" style="margin-top:12px"></div>

        <div style="margin-top:12px;border-top:1px dashed rgba(199,123,123,.06);padding-top:12px">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div style="font-weight:700">Subtotal</div>
            <div class="cart-total" id="cartSubtotal">AED 0</div>
          </div>
          <div style="margin-top:12px;display:flex;gap:8px">
            <button class="btn btn-outline" onclick="clearCart()">Clear</button>
            <button class="btn btn-primary" onclick="openCheckout()">Checkout ‚Äî WhatsApp</button>
          </div>
          <div style="margin-top:12px;font-size:12px;color:var(--muted)">Card payments? <button class="icon-btn" onclick="payPlaceholder()">Pay by Card</button></div>
        </div>
      </aside>

    </div>

    <!-- Footer -->
    <footer id="contact" style="margin-top:28px;padding:36px 18px;background:linear-gradient(180deg,transparent,#faf9fa);border-top:1px solid rgba(199,123,123,.05)">
      <div class="container" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:16px">
        <div>
          <div style="font-family:'Cinzel',serif;font-size:20px;color:var(--rose)">RYAAN JEWELLERS</div>
          <div style="color:var(--muted);margin-top:6px">Dubai ‚Äî handcrafted luxury</div>
          <div style="margin-top:10px;color:var(--muted);font-size:14px">
            <div>üìç Dubai, UAE</div>
            <div>üìû +971 54 374 6476</div>
            <div>‚úâÔ∏è info@ryaanjewellers.com</div>
          </div>
        </div>
        <div style="display:flex;flex-direction:column;gap:12px;align-items:flex-end">
          <div style="display:flex;gap:12px;align-items:center">
            <a href="https://wa.me/971543746476" style="color:#25D366;font-size:14px;display:flex;align-items:center;gap:8px"><i class="fab fa-whatsapp fa-lg"></i> WhatsApp Order</a>
            <a href="#" style="color:var(--rose);font-size:14px;display:flex;align-items:center;gap:8px"><i class="fab fa-instagram fa-lg"></i> @ryaanjewellers</a>
          </div>
          <div style="color:var(--muted);font-size:12px">¬© 2025 RYAAN JEWELLERS. All rights reserved.</div>
        </div>
      </div>
    </footer>

  </main>

  <!-- PRODUCT QUICK VIEW MODAL -->
  <div id="productModal" class="modal" aria-hidden="true">
    <div class="modal-box" role="dialog" aria-modal="true" aria-label="Product details">
      <div style="display:flex;justify-content:flex-end"><button onclick="closeProductModal()" class="icon-btn"><i class="fas fa-times"></i></button></div>
      <div class="modal-grid" id="productModalContent"></div>
    </div>
  </div>

  <!-- CART MODAL (mobile) -->
  <div id="cartModal" class="modal" aria-hidden="true">
    <div class="modal-box" role="dialog" aria-modal="true">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
        <div style="font-family:'Cinzel',serif;color:var(--rose);font-weight:800;font-size:18px">Your Cart</div>
        <button onclick="closeCart()" class="icon-btn"><i class="fas fa-times"></i></button>
      </div>
      <div id="cartModalItems" style="max-height:60vh;overflow:auto"></div>
      <div style="margin-top:12px;display:flex;justify-content:space-between;align-items:center">
        <div style="font-weight:800;color:var(--rose);font-size:18px" id="cartModalTotal">Total: AED 0</div>
        <div style="display:flex;gap:8px">
          <button class="btn btn-outline" onclick="closeCart()">Continue</button>
          <button class="btn btn-primary" onclick="openCheckout()">Checkout</button>
        </div>
      </div>
    </div>
  </div>

  <!-- CHECKOUT MODAL -->
  <div id="checkoutModal" class="modal" aria-hidden="true">
    <div class="modal-box">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
        <div style="font-family:'Cinzel',serif;color:var(--rose);font-weight:800;font-size:18px">Checkout ‚Äî WhatsApp</div>
        <button onclick="closeCheckout()" class="icon-btn"><i class="fas fa-times"></i></button>
      </div>
      <div id="checkoutContent">
        <div style="margin-bottom:12px;color:var(--rose);font-weight:700">Order summary</div>
        <div id="checkoutItems" style="max-height:220px;overflow:auto;margin-bottom:12px"></div>

        <div style="margin-bottom:12px;color:var(--rose);font-weight:700">Delivery details</div>
        <div style="display:grid;gap:10px;margin-bottom:12px">
          <input id="custName" type="text" placeholder="Full name" style="padding:10px;border-radius:8px;border:1px solid rgba(199,123,123,.12)">
          <input id="custPhone" type="text" placeholder="Phone (e.g. +97150xxxxxxx)" style="padding:10px;border-radius:8px;border:1px solid rgba(199,123,123,.12)">
          <textarea id="custAddress" placeholder="Delivery address in Dubai" rows="3" style="padding:10px;border-radius:8px;border:1px solid rgba(199,123,123,.12)"></textarea>
        </div>

        <div style="display:flex;gap:8px;justify-content:flex-end">
          <button class="btn btn-outline" onclick="closeCheckout()">Cancel</button>
          <button class="btn btn-primary" onclick="sendOrderWhatsApp()">Send via WhatsApp</button>
        </div>
      </div>
    </div>
  </div>

  <!-- NOTIFY -->
  <div id="notify" role="status" aria-live="polite"></div>

  <script>
  /***********************************************
   * CONFIG - PRODUCTION SETTINGS *
   ***********************************************/
  const GOLD_API_KEY = 'goldapi-zw91ysmirop9ad-io'; // Your API key
  const WHATSAPP_NUMBER = '971543746476';
  const GITHUB_BASE_URL = 'https://raw.githubusercontent.com/ryaanjewellers007/ryaanjewellers/main/';

  /********************* PRODUCTS DATA *********************/
  const messikaProducts = [
    {id:100,name:"Messika Move Hoop Earrings",category:"Messika Collection",price:8500,image:GITHUB_BASE_URL+"Messika-Move-Hoop-04407-YG.jpg",altImage:"https://images.unsplash.com/photo-1535632066927-ab7c9ab60908?w=800&h=600&fit=crop",type:"earrings",desc:"Yellow gold move hoop with diamonds"},
    {id:101,name:"Messika Move Uno Mini Hoops",category:"Messika Collection",price:7200,image:GITHUB_BASE_URL+"Messika-Move-UNO-Mini-Hoops-10050-WG-1.jpg",altImage:"https://images.unsplash.com/photo-1535632066927-ab7c9ab60908?w=800&h=600&fit=crop",type:"earrings",desc:"White gold mini hoops"}
  ];

  const allProducts = [
    {id:1,name:"Van Cleef Onyx Bracelet",category:"Van Cleef Inspired",price:9800,image:GITHUB_BASE_URL+"Vancleef%20Bracelet%20Onyx.jpg",type:"bracelet",desc:"Luxury gold bracelet with black onyx"},
    {id:2,name:"Van Cleef Carnelian Bracelet",category:"Van Cleef Inspired",price:10200,image:GITHUB_BASE_URL+"Vancleef%20Bracelet%20Carnelian.jpg",type:"bracelet",desc:"Gold bracelet with carnelian"},
    {id:3,name:"Serpenti Choker Necklace",category:"Bvlgari Inspired",price:12500,image:GITHUB_BASE_URL+"Serpenti%20Bvulgari%20Chocker.jpg",type:"necklace",desc:"Iconic serpent design"},
    {id:10,name:"Butterfly Diamond Ring",category:"Messika Inspired",price:4850,image:GITHUB_BASE_URL+"Butterfly%20Ring.jpg",type:"ring",desc:"Delicate butterfly motif"},
    ...messikaProducts
  ];

  /********************* STATE *********************/
  let cart = JSON.parse(localStorage.getItem('ryaanCart') || '[]');
  let currentSlide = 0;
  let autoSlide = null;
  let missingImages = [];

  /********************* UTILS *********************/
  function el(sel){ return document.querySelector(sel); }
  function showNotification(msg,type='info'){
    const n = el('#notify'); n.textContent=msg; 
    n.style.backgroundColor = type==='success' ? '#4CAF50' : (type==='warning' ? '#ff9800' : 'var(--rose)'); 
    n.style.display='block';
    n.style.transform='translateX(0)'; 
    setTimeout(()=>{ n.style.transform='translateX(100%)'; setTimeout(()=>n.style.display='none',300); }, 2800);
  }
  function escapeHtml(s){ return String(s).replace(/[&<>"']/g, (m)=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

  /********************* SPLASH BEHAVIOR *********************/
  const splash = el('#splash');
  const splashVideo = el('#splashVideo');
  const enterBtn = el('#enterBtn');
  const soundToggle = el('#soundToggle');

  soundToggle.addEventListener('click', ()=>{
    const pressed = soundToggle.getAttribute('aria-pressed') === 'true';
    if(pressed){
      splashVideo.muted = true;
      document.getElementById('logoVid').muted = true;
      soundToggle.setAttribute('aria-pressed','false');
      soundToggle.innerHTML = '<i class="fas fa-volume-mute"></i> Enable Sound';
    } else {
      splashVideo.muted = false;
      document.getElementById('logoVid').muted = false;
      soundToggle.setAttribute('aria-pressed','true');
      soundToggle.innerHTML = '<i class="fas fa-volume-up"></i> Sound On';
    }
  });

  enterBtn.addEventListener('click', ()=>{ hideSplash(); });

  setTimeout(()=>{ if(splash && splash.style.display !== 'none') hideSplash(); }, 6000);

  function hideSplash(){
    if(!splash) return;
    splash.style.opacity='0'; splash.style.pointerEvents='none';
    setTimeout(()=>{ splash.style.display='none'; }, 650);
  }

  /********************* GOLD RATES *********************/
  async function fetchGoldRates() {
    const el24 = el('#rate24');
    const el22 = el('#rate22');
    const el18 = el('#rate18');
    const elTime = el('#rateTime');
    
    el24.textContent = '...';
    el22.textContent = '...';
    el18.textContent = '...';
    
    try {
      // Test if API key is valid
      if (!GOLD_API_KEY || GOLD_API_KEY.includes('goldapi-')) {
        console.warn('Using test API key - showing sample data');
        throw new Error('Test API key detected');
      }
      
      // Fetch from GoldAPI.io
      const response = await fetch('https://www.goldapi.io/api/XAU/AED', {
        headers: {
          'x-access-token': GOLD_API_KEY,
          'Content-Type': 'application/json'
        }
      });
      
      if (!response.ok) {
        const errorText = await response.text();
        console.error('Gold API error:', response.status, errorText);
        throw new Error(`API error: ${response.status}`);
      }
      
      const data = await response.json();
      
      if (data.error) {
        throw new Error(data.error);
      }
      
      // Convert price from per ounce to per gram
      // 1 ounce = 31.1034768 grams
      const pricePerGram = data.price / 31.1034768;
      
      // Update display
      el24.textContent = `AED ${pricePerGram.toFixed(2)}`;
      el22.textContent = `AED ${(pricePerGram * (22/24)).toFixed(2)}`;
      el18.textContent = `AED ${(pricePerGram * (18/24)).toFixed(2)}`;
      
      // Format timestamp
      const updateTime = data.timestamp ? 
        new Date(data.timestamp * 1000).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) :
        new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
      
      elTime.textContent = `Live: ${updateTime}`;
      
      console.log('Gold rates updated successfully:', data);
      
    } catch (error) {
      console.warn('Failed to fetch live gold rates:', error.message);
      
      // Fallback to realistic Dubai gold rates (sample data)
      const base = 240.50 + (Math.random() * 3 - 1.5);
      
      el24.textContent = `AED ${base.toFixed(2)}`;
      el22.textContent = `AED ${(base * (22/24)).toFixed(2)}`;
      el18.textContent = `AED ${(base * (18/24)).toFixed(2)}`;
      
      // Show appropriate message
      if (error.message.includes('Test API key')) {
        elTime.textContent = 'Sample rates - Add real API key';
        showNotification('Using sample gold rates. Add real API key for live data.', 'info');
      } else if (error.message.includes('401') || error.message.includes('403')) {
        elTime.textContent = 'Invalid API key';
        showNotification('Gold API key invalid. Check your subscription.', 'warning');
      } else {
        elTime.textContent = 'Sample rates (API error)';
      }
    }
  }

  // Test API function
  async function testGoldAPI() {
    try {
      const response = await fetch('https://www.goldapi.io/api/XAU/AED', {
        headers: {
          'x-access-token': GOLD_API_KEY,
          'Content-Type': 'application/json'
        }
      });
      
      console.log('API Test - Status:', response.status);
      const data = await response.json();
      console.log('API Test - Data:', data);
      
      if (response.ok) {
        showNotification('Gold API connected successfully!', 'success');
      } else {
        showNotification(`API error: ${response.status}`, 'warning');
      }
    } catch (error) {
      console.error('API test failed:', error);
      showNotification('API test failed. Using fallback rates.', 'warning');
    }
  }

  // Initialize gold rates
  fetchGoldRates();
  // Test API after 2 seconds
  setTimeout(testGoldAPI, 2000);
  // Refresh every 5 minutes
  setInterval(fetchGoldRates, 300000);

  /********************* IMAGE CHECKER *********************/
  function checkImage(url){ 
    return new Promise(resolve => { 
      if(!url) return resolve(false); 
      const img=new Image(); 
      img.onload=()=>resolve(true); 
      img.onerror=()=>resolve(false); 
      img.src=url; 
    }); 
  }

  /********************* SLIDER & PRODUCTS RENDER *********************/
  async function renderSlider(){
    const track = el('#sliderTrack'); track.innerHTML='';
    const featured = [ allProducts[0], allProducts[2], allProducts.find(p=>p.id===100), allProducts[10] ].filter(Boolean);
    
    for(const p of featured){
      const ok = await checkImage(p.image);
      const src = ok ? p.image : (p.altImage || placeHolderImage());
      if(!ok) missingImages.push({name:p.name,url:p.image});
      
      const s = document.createElement('div'); s.className='slide';
      s.innerHTML = `
        <img src="${src}" alt="${escapeHtml(p.name)}">
        <div class="meta">
          <div style="font-size:13px;color:var(--muted)">${escapeHtml(p.category||'')}</div>
          <div style="font-weight:800;margin:6px 0">${escapeHtml(p.name)}</div>
          <div style="color:var(--rose);font-weight:900">AED ${p.price.toLocaleString()}</div>
          <div style="margin-top:12px;display:flex;gap:8px">
            <button class="btn btn-primary" onclick="addToCart(${p.id})">Add to Cart</button>
            <button class="btn btn-outline" onclick="showProductModal(${p.id})">View Details</button>
          </div>
        </div>`;
      track.appendChild(s);
    }
    updateSliderPosition(); startAutoSlide();
  }

  function placeHolderImage(){ 
    return 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjBmMGYwIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNHB4IiBmaWxsPSIjODA4MDgwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5JbWFnZSBBdmFpbGFibGU8L3RleHQ+PC9zdmc+'; 
  }

  function updateSliderPosition(){
    const track = el('#sliderTrack'); 
    const slides = document.querySelectorAll('.slide');
    if(slides.length===0) return;
    const slideWidth = slides[0].offsetWidth + 14;
    track.style.transform = `translateX(${-currentSlide * slideWidth}px)`;
  }
  
  function nextSlide(){ 
    const slides=document.querySelectorAll('.slide'); 
    if(slides.length===0) return; 
    currentSlide=(currentSlide+1)%slides.length; 
    updateSliderPosition(); 
    resetAutoSlide(); 
  }
  
  function prevSlide(){ 
    const slides=document.querySelectorAll('.slide'); 
    if(slides.length===0) return; 
    currentSlide=(currentSlide-1+slides.length)%slides.length; 
    updateSliderPosition(); 
    resetAutoSlide(); 
  }
  
  function startAutoSlide(){ clearInterval(autoSlide); autoSlide=setInterval(nextSlide,4500); }
  function resetAutoSlide(){ clearInterval(autoSlide); startAutoSlide(); }

  /* PRODUCT RENDER */
  let currentFilter='all', currentSort='featured';
  async function renderProducts(){
    const grid = el('#productsGrid'); grid.innerHTML=''; missingImages=[];
    
    // search filter
    const q = (el('#searchInput').value || '').trim().toLowerCase();
    let list = allProducts.slice();
    if(q) list = list.filter(p => (p.name + ' ' + (p.desc||'') + ' ' + (p.category||'')).toLowerCase().includes(q));
    
    // type/category filter
    if(currentFilter !== 'all'){
      if(currentFilter.startsWith('category:')){
        const cat = currentFilter.replace('category:','');
        list = list.filter(p => p.category === cat);
      } else {
        list = list.filter(p => p.type === currentFilter);
      }
    }
    
    // sort
    if(currentSort === 'price-asc') list.sort((a,b)=>a.price-b.price);
    if(currentSort === 'price-desc') list.sort((a,b)=>b.price-a.price);
    if(currentSort === 'name-asc') list.sort((a,b)=>a.name.localeCompare(b.name));
    
    for(const p of list){
      const ok = await checkImage(p.image);
      const src = ok ? p.image : (p.altImage || placeHolderImage());
      if(!ok) missingImages.push({name:p.name,url:p.image});
      
      const card = document.createElement('div'); card.className='product';
      card.innerHTML = `
        <img src="${src}" alt="${escapeHtml(p.name)}" loading="lazy">
        <div class="info">
          <div class="badges"><div class="badge">${escapeHtml(p.category||'')}</div></div>
          <div class="name">${escapeHtml(p.name)}</div>
          <div class="desc">${escapeHtml(p.desc||p.description||'')}</div>
          <div style="display:flex;align-items:center;justify-content:space-between;margin-top:12px">
            <div class="price">AED ${p.price.toLocaleString()}</div>
            <div style="display:flex;gap:8px">
              <button class="btn btn-outline" onclick="showProductModal(${p.id})">View</button>
              <button class="btn btn-primary" onclick="addToCart(${p.id})">Add</button>
            </div>
          </div>
        </div>`;
      grid.appendChild(card);
    }
    
    // debug missing images
    if(missingImages.length>0){
      el('#debugSection').style.display='block';
      const dl = el('#debugList'); dl.innerHTML='';
      missingImages.forEach(m=>{ 
        const li=document.createElement('li'); 
        li.innerHTML=`<strong>${escapeHtml(m.name)}</strong> ‚Äî ${escapeHtml(m.url.replace(GITHUB_BASE_URL,''))}`; 
        dl.appendChild(li); 
      });
    } else {
      el('#debugSection').style.display='none';
    }
    
    updateCartUI();
  }

  function applyFilter(type, btn){
    document.querySelectorAll('#filterRow button').forEach(b=>b.classList.remove('active'));
    if(btn) btn.classList.add('active');
    currentFilter = type;
    renderProducts();
  }
  
  function applyFilterByCategory(cat, btn){
    document.querySelectorAll('#filterRow button').forEach(b=>b.classList.remove('active'));
    if(btn) btn.classList.add('active');
    currentFilter = 'category:'+cat;
    renderProducts();
  }
  
  function applySort(val){ currentSort = val; renderProducts(); }
  
  el('#searchBtn').addEventListener('click', ()=>renderProducts());
  el('#searchInput').addEventListener('keydown', e=>{ if(e.key==='Enter') renderProducts(); });

  /********************* CART *********************/
  function saveCart(){ 
    localStorage.setItem('ryaanCart', JSON.stringify(cart)); 
    updateCartUI(); 
  }
  
  function updateCartUI(){
    const cnt = cart.reduce((s,i)=>s+i.quantity,0);
    const cc = el('#cartCount'); 
    cc.textContent = cnt>0?cnt:''; 
    cc.style.display = cnt>0?'inline-block':'none';
    
    // side preview
    const preview = el('#cartPreview'); preview.innerHTML='';
    let total = 0;
    
    if(cart.length===0){ 
      preview.innerHTML='<div style="color:var(--muted)">Your cart is empty</div>'; 
      el('#cartSubtotal').textContent='AED 0'; 
      return; 
    }
    
    cart.forEach((it,idx)=>{
      total += it.price*it.quantity;
      const row = document.createElement('div'); row.className='cart-item';
      row.innerHTML = `
        <img src="${it.image}" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNzAiIGhlaWdodD0iNzAiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9IiNmMGYwZjAiLz48dGV4dCB4PSI1MCUiIHk9IjUwJSIgZm9udC1zaXplPSIxMHB4IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjODA4MDgwIj5QbGFjZWhvbGRlcjwvdGV4dD48L3N2Zz4='">
        <div style="flex:1">
          <div style="font-weight:700">${escapeHtml(it.name)}</div>
          <div style="color:var(--muted);font-size:13px">AED ${it.price.toLocaleString()} √ó ${it.quantity}</div>
        </div>
        <div style="display:flex;flex-direction:column;gap:6px">
          <button class="icon-btn" onclick="updateQuantity(${idx}, ${it.quantity + 1})">+</button>
          <button class="icon-btn" onclick="updateQuantity(${idx}, ${it.quantity - 1})" ${it.quantity<=1?'disabled':''}>-</button>
        </div>`;
      preview.appendChild(row);
    });
    
    el('#cartSubtotal').textContent = `AED ${total.toLocaleString()}`;
    
    // modal summary
    const modalList = el('#cartModalItems'); 
    if(modalList){ 
      modalList.innerHTML=''; 
      cart.forEach((it,idx)=>{ 
        const r=document.createElement('div'); 
        r.style.padding='10px 0'; 
        r.style.borderBottom='1px solid rgba(199,123,123,.06)'; 
        r.innerHTML=`
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <strong>${escapeHtml(it.name)}</strong>
              <div style="font-size:13px;color:var(--muted)">Qty: ${it.quantity} √ó AED ${it.price.toLocaleString()}</div>
            </div>
            <div style="text-align:right">AED ${(it.price*it.quantity).toLocaleString()}</div>
          </div>`; 
        modalList.appendChild(r); 
      }); 
      el('#cartModalTotal').textContent=`Total: AED ${cart.reduce((s,i)=>s+i.price*i.quantity,0).toLocaleString()}`; 
    }
  }
  
  function addToCart(id){
    const p = allProducts.find(x=>x.id===id);
    if(!p){ showNotification('Product not found'); return; }
    
    const ex = cart.find(i=>i.id===id);
    if(ex) ex.quantity++;
    else cart.push({id:p.id,name:p.name,price:p.price,image:p.image,quantity:1});
    
    saveCart();
    showNotification(`${p.name} added to cart`,'success');
  }
  
  function updateQuantity(index,newQty){
    if(newQty<1){ cart.splice(index,1); } 
    else { cart[index].quantity=newQty; }
    saveCart(); 
    renderProducts();
  }
  
  function removeFromCart(index){ cart.splice(index,1); saveCart(); }
  function clearCart(){ cart=[]; saveCart(); showNotification('Cart cleared'); }

  function openCart(){ el('#cartModal').style.display='flex'; document.body.style.overflow='hidden'; }
  function closeCart(){ el('#cartModal').style.display='none'; document.body.style.overflow='auto'; }

  /********************* CHECKOUT (WhatsApp) *********************/
  function openCheckout(){
    if(cart.length===0){ showNotification('Your cart is empty'); return; }
    const container = el('#checkoutItems'); container.innerHTML=''; 
    let total=0;
    
    cart.forEach((it,idx)=>{ 
      const subtotal = it.price*it.quantity; 
      total+=subtotal; 
      const row=document.createElement('div'); 
      row.style.padding='8px 0'; 
      row.style.borderBottom='1px solid rgba(199,123,123,.1)'; 
      row.innerHTML=`
        <div style="display:flex;justify-content:space-between">
          <div>
            <strong>${escapeHtml(it.name)}</strong>
            <div style="font-size:13px;color:var(--muted)">Qty: ${it.quantity} √ó AED ${it.price.toLocaleString()}</div>
          </div>
          <div style="font-weight:700">AED ${subtotal.toLocaleString()}</div>
        </div>`; 
      container.appendChild(row); 
    });
    
    el('#checkoutModal').style.display='flex'; 
    document.body.style.overflow='hidden';
  }
  
  function closeCheckout(){ el('#checkoutModal').style.display='none'; document.body.style.overflow='auto'; }

  function sendOrderWhatsApp(){
    const name = el('#custName').value.trim(); 
    const phone = el('#custPhone').value.trim(); 
    const address = el('#custAddress').value.trim();
    
    if(!name || !phone || !address){ 
      showNotification('Please fill in delivery details'); 
      return; 
    }
    
    let formatted = phone.replace(/\D/g,'');
    if(!formatted.startsWith('971') && formatted.length===9) formatted = '971'+formatted;
    if(formatted.length===10 && formatted.startsWith('0')) formatted = '971'+formatted.slice(1);
    
    let msg = `üõçÔ∏è RYAAN JEWELLERS ‚Äî ORDER\n\nCustomer: ${name}\nPhone: ${phone}\nAddress: ${address}\n\nItems:\n`;
    let total=0;
    
    cart.forEach((it,idx)=>{ 
      const sub=it.price*it.quantity; 
      total+=sub; 
      msg += `${idx+1}. ${it.name} ‚Äî Qty: ${it.quantity} ‚Äî AED ${sub}\n`; 
    });
    
    msg += `\nTotal: AED ${total}\n\nPlease confirm and provide delivery timing.`;
    const url = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`;
    
    window.open(url,'_blank');
    cart=[]; saveCart(); closeCheckout(); closeCart(); 
    showNotification('Order opened in WhatsApp','success');
    
    el('#custName').value=''; el('#custPhone').value=''; el('#custAddress').value='';
  }

  /********************* CUSTOM DESIGN *********************/
  function openCustomInquiry() {
    const msg = `üõçÔ∏è RYAAN JEWELLERS ‚Äî CUSTOM DESIGN INQUIRY\n\nHello, I'm interested in a custom jewellery design. Please contact me to discuss.`;
    const url = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`;
    window.open(url, '_blank');
    showNotification('Opening WhatsApp for custom design inquiry', 'success');
  }

  /********************* QUICK VIEW *********************/
  function showProductModal(id){
    const p = allProducts.find(x=>x.id===id);
    if(!p) return;
    
    const content = el('#productModalContent'); content.innerHTML='';
    
    const imgDiv = document.createElement('div'); 
    imgDiv.innerHTML = `<img src="${p.image}" alt="${escapeHtml(p.name)}" style="width:100%;height:auto;max-height:520px;object-fit:cover" onerror="this.src='${placeHolderImage()}'">`;
    
    const meta = document.createElement('div'); 
    meta.innerHTML = `
      <h3 style="margin-top:0">${escapeHtml(p.name)}</h3>
      <div style="color:var(--muted);margin-bottom:8px">${escapeHtml(p.category||'')}</div>
      <div style="font-weight:900;color:var(--rose);font-size:20px">AED ${p.price.toLocaleString()}</div>
      <p style="margin-top:12px;color:var(--muted)">${escapeHtml(p.desc||p.description||'')}</p>
      <div style="margin-top:12px;display:flex;gap:8px">
        <button class="btn btn-primary" onclick="addToCart(${p.id}); closeProductModal();">Add to Cart</button>
        <button class="btn btn-outline" onclick="openCheckout()">Checkout</button>
      </div>`;
    
    content.appendChild(imgDiv); 
    content.appendChild(meta);
    el('#productModal').style.display='flex'; 
    document.body.style.overflow='hidden';
  }
  
  function closeProductModal(){ el('#productModal').style.display='none'; document.body.style.overflow='auto'; }

  /********************* CARD PAYMENT PLACEHOLDER *********************/
  function payPlaceholder(){
    showNotification('Card payment is not configured. Use WhatsApp checkout or ask me to add Stripe/Tap integration.', 'info');
  }

  /********************* THEME & DIRECTION (LTR/RTL) *********************/
  const themeToggle = el('#themeToggle');
  const dirToggle = el('#dirToggle');

  function applySavedPreferences(){
    const theme = localStorage.getItem('ryaan_theme') || 'auto';
    if(theme === 'auto'){
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      document.documentElement.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
    } else {
      document.documentElement.setAttribute('data-theme', theme === 'dark' ? 'dark' : 'light');
    }
    
    // set icon
    themeToggle.innerHTML = document.documentElement.getAttribute('data-theme') === 'dark' ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';

    const dir = localStorage.getItem('ryaan_dir') || 'ltr';
    document.documentElement.dir = dir;
    dirToggle.textContent = dir === 'ltr' ? 'AR' : 'EN';
  }
  
  applySavedPreferences();

  // toggle theme (cycle: light -> dark -> auto)
  themeToggle.addEventListener('click', ()=>{
    const current = localStorage.getItem('ryaan_theme') || 'auto';
    let next;
    if(current === 'auto') next = 'dark';
    else if(current === 'dark') next = 'light';
    else next = 'auto';
    
    localStorage.setItem('ryaan_theme', next);
    applySavedPreferences();
    showNotification(`Theme: ${next}`, 'success');
  });

  // toggle direction (ltr <-> rtl)
  dirToggle.addEventListener('click', ()=>{
    const current = document.documentElement.dir || 'ltr';
    const next = current === 'ltr' ? 'rtl' : 'ltr';
    document.documentElement.dir = next;
    localStorage.setItem('ryaan_dir', next);
    dirToggle.textContent = next === 'ltr' ? 'AR' : 'EN';
    showNotification(`Direction: ${next}`, 'success');
  });

  /********************* INIT *********************/
  async function init(){
    await renderSlider();
    await renderProducts();
    
    if(localStorage.getItem('ryaanCart')){ 
      cart = JSON.parse(localStorage.getItem('ryaanCart')); 
      updateCartUI(); 
    }
    
    // slider drag
    const track = el('#sliderTrack');
    let isDown=false, startX=0, prevTranslate=0;
    
    track.addEventListener('pointerdown', (e)=>{ 
      isDown=true; 
      startX=e.clientX; 
      track.style.cursor='grabbing'; 
      clearInterval(autoSlide); 
    });
    
    track.addEventListener('pointermove', (e)=>{ 
      if(!isDown) return; 
      e.preventDefault(); 
      const currentX=e.clientX; 
      const diff = currentX - startX; 
      track.style.transform = `translateX(${prevTranslate + diff}px)`; 
    });
    
    track.addEventListener('pointerup', ()=>{ 
      isDown=false; 
      track.style.cursor='grab'; 
      startAutoSlide(); 
    });
    
    track.addEventListener('pointerleave', ()=>{ 
      if(isDown){ 
        isDown=false; 
        track.style.cursor='grab'; 
        startAutoSlide(); 
      }
    });
    
    // keyboard
    document.addEventListener('keydown', (e)=>{ 
      if(e.key==='Escape'){ 
        closeProductModal(); 
        closeCart(); 
        closeCheckout(); 
      } 
    });
    
    // search debounce
    let timer; 
    el('#searchInput').addEventListener('input', ()=>{ 
      clearTimeout(timer); 
      timer=setTimeout(()=>renderProducts(),300); 
    });
  }
  
  document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
